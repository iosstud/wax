"use strict";(globalThis.webpackChunkwax_docs=globalThis.webpackChunkwax_docs||[]).push([[8],{8857(e,i,n){n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>l});const d=JSON.parse('{"id":"vector-search/embedding-providers","title":"Embedding Providers","description":"Implement the TextEmbeddingProvider protocol to supply vector embeddings from any source.","source":"@site/docs/vector-search/embedding-providers.md","sourceDirName":"vector-search","slug":"/vector-search/embedding-providers","permalink":"/docs/vector-search/embedding-providers","draft":false,"unlisted":false,"editUrl":"https://github.com/christopherkarani/Wax/tree/main/website/docs/vector-search/embedding-providers.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Embedding Providers","sidebar_label":"Embedding Providers"},"sidebar":"docs","previous":{"title":"Vector Search Engines","permalink":"/docs/vector-search/vector-search-engines"},"next":{"title":"MiniLM Embedder","permalink":"/docs/mini-lm/mini-lm-embedder"}}');var r=n(4848),t=n(8453);const o={sidebar_position:2,title:"Embedding Providers",sidebar_label:"Embedding Providers"},s=void 0,c={},l=[{value:"Overview",id:"overview",level:2},{value:"The EmbeddingProvider Protocol",id:"the-embeddingprovider-protocol",level:2},{value:"Required Properties",id:"required-properties",level:3},{value:"Execution Mode",id:"execution-mode",level:3},{value:"Batch Embedding",id:"batch-embedding",level:2},{value:"Embedding Identity",id:"embedding-identity",level:2},{value:"Building a Custom Provider",id:"building-a-custom-provider",level:2},{value:"Built-in Provider",id:"built-in-provider",level:2}];function a(e){const i={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:"Implement the TextEmbeddingProvider protocol to supply vector embeddings from any source."}),"\n",(0,r.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"EmbeddingProvider"})," protocol defines a pluggable interface for converting text into fixed-dimensional vector embeddings. Any conforming type can be used with Wax's vector search and RAG systems."]}),"\n",(0,r.jsx)(i.h2,{id:"the-embeddingprovider-protocol",children:"The EmbeddingProvider Protocol"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-swift",children:"public protocol EmbeddingProvider: Sendable {\n    var dimensions: Int { get }\n    var normalize: Bool { get }\n    var identity: EmbeddingIdentity? { get }\n    var executionMode: ProviderExecutionMode { get }\n    func embed(_ text: String) async throws -> [Float]\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"required-properties",children:"Required Properties"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Property"}),(0,r.jsx)(i.th,{children:"Purpose"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"dimensions"})}),(0,r.jsx)(i.td,{children:"Vector dimensionality (e.g., 384 for MiniLM, 1536 for OpenAI)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"normalize"})}),(0,r.jsx)(i.td,{children:"Whether output vectors are L2-normalized"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"identity"})}),(0,r.jsx)(i.td,{children:"Optional metadata identifying the provider/model"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"executionMode"})}),(0,r.jsx)(i.td,{children:"Whether the provider requires network access"})]})]})]}),"\n",(0,r.jsx)(i.h3,{id:"execution-mode",children:"Execution Mode"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"ProviderExecutionMode"})," controls whether a provider can be used in privacy-sensitive contexts:"]}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Mode"}),(0,r.jsx)(i.th,{children:"Description"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:".onDeviceOnly"})}),(0,r.jsx)(i.td,{children:"All computation is local (e.g., CoreML models)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:".mayUseNetwork"})}),(0,r.jsx)(i.td,{children:"May call cloud services (e.g., OpenAI API)"})]})]})]}),"\n",(0,r.jsxs)(i.p,{children:["When ",(0,r.jsx)(i.code,{children:"OrchestratorConfig.requireOnDeviceProviders"})," is ",(0,r.jsx)(i.code,{children:"true"})," (the default), providers with ",(0,r.jsx)(i.code,{children:".mayUseNetwork"})," are rejected at initialization."]}),"\n",(0,r.jsx)(i.h2,{id:"batch-embedding",children:"Batch Embedding"}),"\n",(0,r.jsxs)(i.p,{children:["For higher throughput during ingestion, implement ",(0,r.jsx)(i.code,{children:"BatchEmbeddingProvider"}),":"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-swift",children:"public protocol BatchEmbeddingProvider: EmbeddingProvider {\n    func embed(batch texts: [String]) async throws -> [[Float]]\n}\n"})}),"\n",(0,r.jsx)(i.p,{children:"Batch providers amortize model initialization and data transfer overhead. The orchestrator automatically uses batch embedding when available."}),"\n",(0,r.jsx)(i.h2,{id:"embedding-identity",children:"Embedding Identity"}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"EmbeddingIdentity"})," provides metadata for provenance tracking:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-swift",children:'public struct EmbeddingIdentity: Sendable, Equatable {\n    public var provider: String?    // e.g., "Wax"\n    public var model: String?       // e.g., "MiniLMAll"\n    public var dimensions: Int?     // e.g., 384\n    public var normalized: Bool?    // e.g., true\n}\n'})}),"\n",(0,r.jsx)(i.p,{children:"This identity is stored alongside the vector index to detect embedding model changes."}),"\n",(0,r.jsx)(i.h2,{id:"building-a-custom-provider",children:"Building a Custom Provider"}),"\n",(0,r.jsx)(i.p,{children:"Here's a minimal on-device provider:"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-swift",children:'public actor MyEmbedder: EmbeddingProvider, BatchEmbeddingProvider {\n    public let dimensions = 384\n    public let normalize = true\n    public let executionMode = ProviderExecutionMode.onDeviceOnly\n\n    public var identity: EmbeddingIdentity? {\n        EmbeddingIdentity(\n            provider: "MyApp",\n            model: "custom-v1",\n            dimensions: 384,\n            normalized: true\n        )\n    }\n\n    public func embed(_ text: String) async throws -> [Float] {\n        // Your embedding logic here\n    }\n\n    public func embed(batch texts: [String]) async throws -> [[Float]] {\n        // Batch embedding for throughput\n    }\n}\n'})}),"\n",(0,r.jsx)(i.h2,{id:"built-in-provider",children:"Built-in Provider"}),"\n",(0,r.jsx)(i.p,{children:"The WaxVectorSearchMiniLM module provides a ready-to-use on-device provider based on the all-MiniLM-L6-v2 model. See the WaxVectorSearchMiniLM documentation for details."})]})}function h(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453(e,i,n){n.d(i,{R:()=>o,x:()=>s});var d=n(6540);const r={},t=d.createContext(r);function o(e){const i=d.useContext(t);return d.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),d.createElement(t.Provider,{value:i},e.children)}}}]);