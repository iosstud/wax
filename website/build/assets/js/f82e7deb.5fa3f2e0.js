"use strict";(globalThis.webpackChunkwax_docs=globalThis.webpackChunkwax_docs||[]).push([[174],{8449(e,t,n){n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"core/getting-started","title":"WaxCore Getting Started","description":"Create, open, and interact with .mv2s memory files using the Wax actor.","source":"@site/docs/core/getting-started.md","sourceDirName":"core","slug":"/core/getting-started","permalink":"/docs/core/getting-started","draft":false,"unlisted":false,"editUrl":"https://github.com/christopherkarani/Wax/tree/main/website/docs/core/getting-started.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"WaxCore Getting Started","sidebar_label":"Getting Started"},"sidebar":"docs","previous":{"title":"Video RAG","permalink":"/docs/media/video-rag"},"next":{"title":"File Format","permalink":"/docs/core/file-format"}}');var i=n(4848),a=n(8453);const s={sidebar_position:1,title:"WaxCore Getting Started",sidebar_label:"Getting Started"},o=void 0,l={},c=[{value:"Overview",id:"overview",level:2},{value:"Creating a Store",id:"creating-a-store",level:2},{value:"Opening an Existing Store",id:"opening-an-existing-store",level:2},{value:"Writing Frames",id:"writing-frames",level:2},{value:"Reading Frames",id:"reading-frames",level:2},{value:"Committing Changes",id:"committing-changes",level:2},{value:"Closing the Store",id:"closing-the-store",level:2}];function d(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["Create, open, and interact with ",(0,i.jsx)(t.code,{children:".mv2s"})," memory files using the Wax actor."]}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["WaxCore is the persistence foundation for all Wax modules. Every operation \u2014 text indexing, vector search, structured memory \u2014 ultimately stores data as ",(0,i.jsx)(t.strong,{children:"frames"})," inside a ",(0,i.jsx)(t.code,{children:".mv2s"})," file managed by the ",(0,i.jsx)(t.code,{children:"Wax"})," actor."]}),"\n",(0,i.jsx)(t.h2,{id:"creating-a-store",children:"Creating a Store"}),"\n",(0,i.jsxs)(t.p,{children:["Use ",(0,i.jsx)(t.code,{children:"Wax/create(at:walSize:options:)"})," to create a new ",(0,i.jsx)(t.code,{children:".mv2s"})," file:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:'import WaxCore\n\nlet url = URL(filePath: "/path/to/memory.mv2s")\nlet store = try await Wax.create(at: url)\n'})}),"\n",(0,i.jsx)(t.p,{children:"You can customize the WAL ring buffer size and fsync policy:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:"let options = WaxOptions(\n    fsyncPolicy: .everyBytes(1_048_576),  // fsync every 1 MiB\n    enableReplayStateSnapshot: true\n)\nlet store = try await Wax.create(\n    at: url,\n    walSize: 128 * 1024 * 1024,  // 128 MiB WAL\n    options: options\n)\n"})}),"\n",(0,i.jsx)(t.h2,{id:"opening-an-existing-store",children:"Opening an Existing Store"}),"\n",(0,i.jsxs)(t.p,{children:["Use ",(0,i.jsx)(t.code,{children:"Wax/open(at:options:)"})," to open a previously created file. If the WAL contains uncommitted records, they are automatically replayed during open:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:"let store = try await Wax.open(at: url)\n"})}),"\n",(0,i.jsx)(t.h2,{id:"writing-frames",children:"Writing Frames"}),"\n",(0,i.jsxs)(t.p,{children:["All writes require a ",(0,i.jsx)(t.strong,{children:"writer lease"})," \u2014 only one writer can be active at a time:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:"let lease = try await store.acquireWriterLease(policy: .wait)\n\nlet frameId = try await store.putFrame(/* frame data */)\n\ntry await store.commit()\nstore.releaseWriterLease(lease)\n"})}),"\n",(0,i.jsx)(t.p,{children:"The writer policy controls what happens when another writer already holds the lease:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"WaxWriterPolicy/fail"})," \u2014 Immediately throws ",(0,i.jsx)(t.code,{children:"WaxError/writerBusy"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"WaxWriterPolicy/wait"})," \u2014 Suspends until the lease becomes available"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"WaxWriterPolicy/timeout(_:)"})," \u2014 Waits up to a duration, then throws ",(0,i.jsx)(t.code,{children:"WaxError/writerTimeout"})]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"reading-frames",children:"Reading Frames"}),"\n",(0,i.jsx)(t.p,{children:"Reads do not require a writer lease and can execute concurrently:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:'let stats = await store.stats()\nprint("Frame count: \\(stats.frameCount)")\n\nif let meta = await store.frame(id: 0) {\n    let payload = try await store.readPayload(\n        at: meta.payloadOffset,\n        length: meta.payloadLength\n    )\n}\n'})}),"\n",(0,i.jsx)(t.h2,{id:"committing-changes",children:"Committing Changes"}),"\n",(0,i.jsxs)(t.p,{children:["After writing frames, call ",(0,i.jsx)(t.code,{children:"Wax/commit()"})," to flush the WAL, write the updated TOC and footer, and update the header:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:"try await store.commit()\n"})}),"\n",(0,i.jsx)(t.p,{children:"Until a commit, writes exist only in the WAL ring buffer. The WAL provides crash safety \u2014 uncommitted records are replayed automatically on next open."}),"\n",(0,i.jsx)(t.h2,{id:"closing-the-store",children:"Closing the Store"}),"\n",(0,i.jsx)(t.p,{children:"Always close the store when done:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-swift",children:"try await store.close()\n"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>o});var r=n(6540);const i={},a=r.createContext(i);function s(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);