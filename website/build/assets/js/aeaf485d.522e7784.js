"use strict";(globalThis.webpackChunkwax_docs=globalThis.webpackChunkwax_docs||[]).push([[207],{6022(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"media/video-rag","title":"Video RAG","description":"Search video content by transcript and visual segments with semantic queries.","source":"@site/docs/media/video-rag.md","sourceDirName":"media","slug":"/media/video-rag","permalink":"/docs/media/video-rag","draft":false,"unlisted":false,"editUrl":"https://github.com/christopherkarani/Wax/tree/main/website/docs/media/video-rag.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Video RAG","sidebar_label":"Video RAG"},"sidebar":"docs","previous":{"title":"Photo RAG","permalink":"/docs/media/photo-rag"},"next":{"title":"Getting Started","permalink":"/docs/core/getting-started"}}');var t=i(4848),s=i(8453);const d={sidebar_position:2,title:"Video RAG",sidebar_label:"Video RAG"},c=void 0,l={},o=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Setup",id:"setup",level:2},{value:"Transcript Provider",id:"transcript-provider",level:3},{value:"Ingestion",id:"ingestion",level:2},{value:"From Local Files",id:"from-local-files",level:3},{value:"From Photos Library",id:"from-photos-library",level:3},{value:"Metadata",id:"metadata",level:3},{value:"Querying",id:"querying",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Segment Chunking",id:"segment-chunking",level:2}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Search video content by transcript and visual segments with semantic queries."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"VideoRAGOrchestrator"})," provides retrieval-augmented generation for video content. It segments videos into time windows, extracts keyframes, integrates transcripts, and enables natural-language queries that return specific video segments."]}),"\n",(0,t.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,t.jsx)(n.p,{children:"Each video is represented as a hierarchy of frames:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Frame Kind"}),(0,t.jsx)(n.th,{children:"Content"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"root"})}),(0,t.jsx)(n.td,{children:"Video metadata (source, duration, capture date)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segment"})}),(0,t.jsx)(n.td,{children:"Time-windowed segment with transcript and keyframe embedding"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"Segments are created with configurable duration and overlap, allowing queries to pinpoint specific moments in long videos."}),"\n",(0,t.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"let orchestrator = try await VideoRAGOrchestrator(\n    storeURL: storeURL,\n    config: VideoRAGConfig(),\n    embedder: embedder,                      // Text/multimodal embedding provider\n    transcriptProvider: myTranscriptProvider  // Optional\n)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"transcript-provider",children:"Transcript Provider"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"VideoTranscriptProvider"})," protocol supplies per-video transcripts. Transcripts are segmented and indexed alongside visual embeddings for hybrid text+semantic search."]}),"\n",(0,t.jsx)(n.h2,{id:"ingestion",children:"Ingestion"}),"\n",(0,t.jsx)(n.h3,{id:"from-local-files",children:"From Local Files"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:"let files = [\n    VideoFile(url: videoURL1),\n    VideoFile(url: videoURL2)\n]\ntry await orchestrator.ingest(files: files)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"from-photos-library",children:"From Photos Library"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'try await orchestrator.syncLibrary(scope: .all)\ntry await orchestrator.ingest(photoAssetIDs: ["video-asset-1"])\n'})}),"\n",(0,t.jsx)(n.h3,{id:"metadata",children:"Metadata"}),"\n",(0,t.jsx)(n.p,{children:"Each video and segment stores metadata:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Key"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"source"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.code,{children:"local"})," or ",(0,t.jsx)(n.code,{children:"photos"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"sourceID"})}),(0,t.jsx)(n.td,{children:"Asset or file identifier"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"fileURL"})}),(0,t.jsx)(n.td,{children:"Local file path (if applicable)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"captureMs"})}),(0,t.jsx)(n.td,{children:"Capture timestamp"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"durationMs"})}),(0,t.jsx)(n.td,{children:"Total video duration"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"isLocal"})}),(0,t.jsx)(n.td,{children:"Whether the video is available locally"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"pipelineVersion"})}),(0,t.jsx)(n.td,{children:"Ingestion pipeline version"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentIndex"})}),(0,t.jsx)(n.td,{children:"Segment position within the video"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentCount"})}),(0,t.jsx)(n.td,{children:"Total segments in the video"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentStartMs"})}),(0,t.jsx)(n.td,{children:"Segment start time"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentEndMs"})}),(0,t.jsx)(n.td,{children:"Segment end time"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentMidMs"})}),(0,t.jsx)(n.td,{children:"Segment midpoint"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"querying",children:"Querying"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-swift",children:'let context = try await orchestrator.recall(VideoQuery(\n    text: "discussion about architecture decisions",\n    topK: 5\n))\n\nfor segment in context.segments {\n    print("Video: \\(segment.sourceID)")\n    print("Time: \\(segment.startMs)ms - \\(segment.endMs)ms")\n    print("Transcript: \\(segment.transcript ?? "")")\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Results are grouped by source video and sorted by relevance within each group."}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"VideoRAGConfig"})," controls segmentation and search:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentDurationMs"})}),(0,t.jsx)(n.td,{children:"Duration of each segment in milliseconds"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"segmentOverlapMs"})}),(0,t.jsx)(n.td,{children:"Overlap between adjacent segments"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"transcriptBudget"})}),(0,t.jsx)(n.td,{children:"Max transcript tokens per segment"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"keyframeCount"})}),(0,t.jsx)(n.td,{children:"Keyframes to extract per segment"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"vectorEnginePreference"})}),(0,t.jsx)(n.td,{children:"CPU vs GPU vector engine"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"hybridAlpha"})}),(0,t.jsx)(n.td,{children:"BM25 vs vector blend"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"searchTopK"})}),(0,t.jsx)(n.td,{children:"Candidates to retrieve"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"requireOnDeviceProviders"})}),(0,t.jsx)(n.td,{children:"Reject network-dependent providers"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"segment-chunking",children:"Segment Chunking"}),"\n",(0,t.jsx)(n.p,{children:"Videos are divided into overlapping time windows:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Video: [0s \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 120s]\n\nSegment 1: [0s \u2500\u2500\u2500\u2500 30s]\nSegment 2:      [25s \u2500\u2500\u2500\u2500 55s]     (5s overlap)\nSegment 3:           [50s \u2500\u2500\u2500\u2500 80s]\nSegment 4:                [75s \u2500\u2500\u2500\u2500 105s]\nSegment 5:                     [100s \u2500\u2500 120s]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Each segment gets:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"A keyframe embedding (visual content)"}),"\n",(0,t.jsx)(n.li,{children:"A transcript slice (if available)"}),"\n",(0,t.jsx)(n.li,{children:"Metadata with precise start/end timestamps"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This overlap ensures that content near segment boundaries is captured by at least two segments."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453(e,n,i){i.d(n,{R:()=>d,x:()=>c});var r=i(6540);const t={},s=r.createContext(t);function d(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);