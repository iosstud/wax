# Sources/WaxCore/Concurrency Module

## Purpose
Provides concurrency primitives used by the Wax storage engine for thread-safe file I/O and lock management.

## Key Types

| Type | Role |
|------|------|
| `AsyncReadWriteLock` | Async-aware read/write lock. Allows concurrent reads but exclusive writes. Used by `Wax` actor's `opLock`. |
| `BlockingIOExecutor` | Serial dispatch queue wrapper for file I/O. Executes blocking operations off the cooperative thread pool. |

## Architecture

- `AsyncReadWriteLock` uses continuations internally to suspend/resume waiters without blocking threads.
- `BlockingIOExecutor` is initialized with a label and QoS. All file reads/writes go through `io.run { ... }`.
- These primitives are internal to WaxCore; they are not part of the public API.

## Concurrency Model

- The read/write lock prevents data races during TOC reads vs commits.
- The serial IO queue prevents concurrent file descriptor access which could corrupt data.
- Both are designed for Swift 6.2 strict concurrency (`Sendable` conformance).

## Dependencies

- `Foundation` (DispatchQueue)


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>