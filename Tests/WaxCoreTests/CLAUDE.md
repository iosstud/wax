# Tests/WaxCoreTests

## Purpose
Unit tests for the `WaxCore` module (the `.mv2s` storage engine). Tests cover lifecycle operations, frame CRUD, WAL recovery, commit/verify, and edge cases.

## Test Categories

- **Lifecycle tests**: Create, open, close, reopen, verify. Tests crash recovery and WAL replay.
- **Frame operations**: Put, delete, supersede, putBatch, embeddings. Tests dense frame IDs and metadata.
- **Index staging**: Stage lex/vec indexes, commit, read back. Tests dimension/similarity validation.
- **Writer lease**: Concurrent writer policies (fail, wait, timeout).
- **Verification**: Deep verify (checksum validation of all frame payloads and segments).

## Conventions

- Tests use `FileManager.default.temporaryDirectory` for store URLs.
- Each test creates a fresh `.mv2s` file and cleans up after.
- `XCTAssertEqual` is preferred over `XCTAssertTrue` for value comparisons.

## Running

```bash
swift test --filter WaxCoreTests
```


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>